<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <title>Reddit r/india sub-reddit Data Analysis Part 2 - Hari Govardhanam</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" />
    <!--<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css" rel="stylesheet" />-->
    <!-- <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /> -->
    <link href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" rel="stylesheet" />

    <link href="https://hari.ai/theme/style.css" rel="stylesheet" />
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://hari.ai/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Hari Govardhanam Full Atom Feed" />
  </head>
  <body id="index" class="archive">
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://hari.ai"><i class="fas fa-laptop-code fa-lg"></i> Hari Govardhanam</a>
        </div>
        <!-- <div class="collapse navbar-collapse navbar-left">
          <ul class="nav navbar-nav">
            <li><a class="nav" href="https://hari.ai/about.html"><i class="fas fa-portrait fa-lg"></i> About</a></li>
            <li><a class="nav" href="https://hari.ai/photography.html"><i class="fas fa-camera-retro fa-lg"></i> Photography</a></li>
          </ul>
        </div> -->
        <div class="collapse navbar-collapse navbar-right">
          <ul class="nav navbar-nav">
            <li><a href="https://goodreads.com/harigov"><i class="fab fa-goodreads fa-2x"></i></a></li>
            <li><a href="https://github.com/harigov"><i class="fab fa-github-square fa-2x"></i></a></li>
            <li><a href="https://linkedin.com/in/harigov"><i class="fab fa-linkedin fa-2x"></i></a></li>
            <li><a href="https://hari.ai/feeds/all.atom.xml"><i class="fa fa-rss fa-2x"></i></a></li>
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
    </nav>
    <div class="container">
    <section id="content" class="article content">
      <header>
        <h2 class="entry-title">
          Reddit r/india sub-reddit Data Analysis Part 2
        </h2>
        
        <div class="text-muted">Fri 20 October 2017</div>
      </header>
<!-- .entry-content -->
      <div class="entry-content">
        <p>As I mentioned in my previous post, there is going to be a follow up. The focus in this post is going to be more about trying to identify paid accounts who are posting messages to appear as if they are real. It is clear for any regular participant of this community that there are lots of political posts with people having very strong opinions. Many of these accounts have unnatural obsession with certain politicians and political parties to the point that one wonders if these are real people. Detecting such paid accounts definitively is a research problem but I tried to do reasonable analysis to convince myself.</p>
<p>We have code interspersed in this article just to give you an idea as to how this analysis has been done. Part 1 of this article series will give you more information about the data and how it is processed and stored. If you aren't a coder, please feel free to ignore code blocks and simply focus on the pretty graphs and descriptive text. I promise you will still understand what's going on. If you don't, drop me an email and I will try to improve text to clarify whatever is troubling you.</p>
<div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">tabulate</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s1">&#39;retina&#39;</span>

<span class="k">def</span> <span class="nf">b64decode</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">conn</span><span class="o">=</span><span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;reddit.db&#39;</span><span class="p">)</span>
<span class="n">conn</span><span class="o">.</span><span class="n">create_function</span><span class="p">(</span><span class="s2">&quot;b64decode&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b64decode</span><span class="p">)</span>
<span class="n">cursor</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">imwidth</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">imheight</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">imwidth</span><span class="p">,</span> <span class="n">imheight</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</pre></div>


<h2>Participation in Political Submissions during different months</h2>
<p>First, the low hanging fruits in determining if there are paid accounts trying to influence people is to see if there is a sudden increase in number of posts at anytime in the past year. As you can see below, there was a sudden spike in participation in political submissions starting April. I tried to see if there was a specific date in April when this started and it turns out that there was a gradual increase. What could have happened that triggered such an increase? Taking average of six months activity before April, there was an increase of ~33% in political submissions. I wondered if this could have been because some political discussions related to demonetization had a different flair. Even including those posts, if we exclude December 2016, there was a definite increase in political submissions since April. I have no conclusive evidence on why this is the case.</p>
<div class="highlight"><pre><span></span><span class="c1"># Monthly Political stats</span>
<span class="n">submissions_monthly</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select date(posted_at, &#39;start of month&#39;) as month, count(*) </span>
<span class="s2">    from submissions</span>
<span class="s2">    where link_flair_text==&#39;Politics&#39; group by month&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_monthly</span><span class="p">],</span> 
          <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_monthly</span><span class="p">],</span>
          <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Submissions&#39;</span><span class="p">,</span> <span class="s1">&#39;Political Submissions Per Month&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">submissions_monthly</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select date(posted_at, &#39;start of month&#39;) as month, count(*) </span>
<span class="s2">    from submissions </span>
<span class="s2">    where link_flair_text==&#39;Politics&#39; or link_flair_text==&#39;Demonetization&#39;</span>
<span class="s2">    group by month&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_monthly</span><span class="p">],</span> 
          <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_monthly</span><span class="p">],</span>
          <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Submissions&#39;</span><span class="p">,</span> <span class="s1">&#39;Political Submissions Per Month incl Demonetization&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">submissions_monthly</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select date(posted_at) as date, count(*) </span>
<span class="s2">    from submissions </span>
<span class="s2">    where link_flair_text==&#39;Politics&#39; and date(posted_at, &#39;start of month&#39;)=&#39;2017-04-01&#39;</span>
<span class="s2">    group by date&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_monthly</span><span class="p">],</span> 
          <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_monthly</span><span class="p">],</span>
          <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Submissions&#39;</span><span class="p">,</span> <span class="s1">&#39;Political Submissions Per Month&#39;</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/political_submissions_month.png" width="80%">
<img src="https://hari.ai/images/reddit_da/political_submissions_month_incl_demo.png" width="80%">
<img src="https://hari.ai/images/reddit_da/political_submissions_april_2017.png" width="80%"></p>
<h2>Participation in Political Submissions during an average week</h2>
<p>If the increase in participation is primarily due to paid accounts, we should see a dramatic increase in activity during weekdays compared to weekends. The idea is that a regular user will probably continue accessing reddit during weekends as well but not someone whose job is to be on reddit all day. We look at both political submissions and comments to see if we can find some signals. As you can see below, there is a slight increase in activity over the week but nothing over the top to conclude that there are paid accounts. Either these paid accounts are operated all through the week or there are no paid accounts. We don't know yet.</p>
<div class="highlight"><pre><span></span><span class="c1"># Weekly stats</span>
<span class="n">submissions_weekday</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select weekday, </span>
<span class="s2">           avg(count) from (select strftime(&#39;%w&#39;, posted_at) as weekday,</span>
<span class="s2">           strftime(&#39;%W&#39;, posted_at) as week, count(*) as count </span>
<span class="s2">    from submissions</span>
<span class="s2">    where link_flair_text==&#39;Politics&#39; group by week, weekday)</span>
<span class="s2">    group by weekday&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_weekday</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_weekday</span><span class="p">],</span> <span class="s1">&#39;Weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;Average Submissions&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Average Political Submissions on a Weekday&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">submissions_weekday</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select weekday, </span>
<span class="s2">           avg(num_comments) from (</span>
<span class="s2">               select strftime(&#39;%w&#39;, posted_at) as weekday, </span>
<span class="s2">                      strftime(&#39;%W&#39;, posted_at) as week, </span>
<span class="s2">                      sum(num_comments) as num_comments </span>
<span class="s2">               from submissions where link_flair_text==&#39;Politics&#39; </span>
<span class="s2">               group by week, weekday) </span>
<span class="s2">    group by weekday&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_weekday</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_weekday</span><span class="p">],</span> <span class="s1">&#39;Weekday&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Average Number of Comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Average Political Submission Comments on a Weekday&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/avg_political_submissions_weekday.png" width="80%">
<img src="https://hari.ai/images/reddit_da/avg_political_submission_comments_weekday.png" width="80%"></p>
<h2>Hourly Participation in Political Submissions</h2>
<p>If there was a constant stream of activity during the week, could we find some signal about paid activity if we look at hourly distribution? It turns out that the activity in political submissions seems to match regular non-political activity. And the hourly distribution doesn't give any additional insight into paid user activity. Just to double check, I tried to see if there was a difference in activity during weekday and weekend. Again, no luck.</p>
<div class="highlight"><pre><span></span><span class="c1"># Hourly stats</span>
<span class="n">submissions_hourly</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select (5.5+hour) as hour, </span>
<span class="s2">            avg(count) from (</span>
<span class="s2">                select strftime(&#39;%H&#39;, posted_at) as hour, </span>
<span class="s2">                    date(posted_at) as date, count(*) as count </span>
<span class="s2">                from submissions where link_flair_text==&#39;Politics&#39; </span>
<span class="s2">                group by date, hour) </span>
<span class="s2">    group by hour&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_hourly</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_hourly</span><span class="p">],</span> 
          <span class="s1">&#39;Hours in Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Average Submissions&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Average Political Submissions at different times of the day&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">submissions_hourly</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select (5.5+hour) as hour, avg(count), </span>
<span class="s2">            strftime(&#39;%w&#39;, date) as weekday from (</span>
<span class="s2">                select strftime(&#39;%H&#39;, posted_at) as hour, </span>
<span class="s2">                    date(posted_at) as date, count(*) as count </span>
<span class="s2">                from submissions where link_flair_text==&#39;Politics&#39; </span>
<span class="s2">                group by date, hour) </span>
<span class="s2">    where weekday!=&#39;0&#39; and weekday!=&#39;6&#39;</span>
<span class="s2">    group by hour&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="n">submissions_hourly</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="n">submissions_hourly</span><span class="p">],</span> 
          <span class="s1">&#39;Hours in Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Average Submissions&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Average Political Submissions at different times of the day during weekday&#39;</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">submissions_hourly</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select (5.5+hour) as hour, avg(num_comments) from (</span>
<span class="s2">        select strftime(&#39;%H&#39;, posted_at) as hour, </span>
<span class="s2">            date(posted_at) as date, sum(num_comments) as num_comments </span>
<span class="s2">        from submissions where link_flair_text==&#39;Politics&#39; </span>
<span class="s2">        group by date, hour) </span>
<span class="s2">    group by hour&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_hourly</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">submissions_hourly</span><span class="p">],</span> 
          <span class="s1">&#39;Hours in Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Average Number of Comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Average Political Submission Comments at different times of the day&#39;</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/avg_political_submissions_time_of_day.png" width="80%">
<img src="https://hari.ai/images/reddit_da/avg_political_submissions_time_of_day_weekday.png" width="80%">
<img src="https://hari.ai/images/reddit_da/avg_political_submission_comments_time_of_day.png" width="80%"></p>
<h2>Utterances of different political party names</h2>
<p>The idea behind this political analysis is to see if there are indeed paid accounts and if so who is paying them. Therefore, we look at the utterance of different political party and leader names to see if there is an isolated upward trend. Unfortunately, both Congress and BJP are showing an upward trend. I think the utterance of these political parties sort of matches their appearance in media. I don't know what to make out of this information. If at all, I would rather not judge with this limited information so as to avoid bias. For some strange reason, APP/Kejriwal saw a significant spike in April followed by a dramatic slowdown. An increase in 400 political submissions per month that we saw in April can probably be attributable to whatever caused this significant upward trend for AAP/Kejriwal.</p>
<div class="highlight"><pre><span></span><span class="n">comment_lengths</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select month, count from (</span>
<span class="s2">        select date(posted_at, &#39;start of month&#39;) as month, </span>
<span class="s2">            count(*) as count, sum(score) as score, b64decode(content) as b64comment </span>
<span class="s2">        from comments </span>
<span class="s2">        where b64comment!=&#39;&#39; and (</span>
<span class="s2">            (b64comment LIKE &#39;</span><span class="si">%c</span><span class="s2">ongress%&#39;) or (b64comment LIKE &#39;</span><span class="si">%r</span><span class="s2">aga%&#39;) or </span>
<span class="s2">            (b64comment LIKE &#39;</span><span class="si">%r</span><span class="s2">ahul%&#39;) or (b64comment LIKE &#39;</span><span class="si">%g</span><span class="s2">andhi%&#39;)) </span>
<span class="s2">        group by month)&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span> <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Number of comments referring to Rahul Gandhi or Congress on a Monthly Basis&#39;</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/comments_congress_monthly.png" width="80%"></p>
<div class="highlight"><pre><span></span><span class="n">comment_lengths</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select month, count from (</span>
<span class="s2">        select date(posted_at, &#39;start of month&#39;) as month, count(*) as count, </span>
<span class="s2">            sum(score) as score, b64decode(content) as b64comment</span>
<span class="s2">        from comments</span>
<span class="s2">        where b64comment!=&#39;&#39; and ((b64comment LIKE &#39;%bjp%&#39;) or </span>
<span class="s2">            (b64comment LIKE &#39;%modi%&#39;) or (b64comment LIKE &#39;%namo%&#39;))</span>
<span class="s2">        group by month)&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span>
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span> <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Number of comments referring to Modi or BJP on a Monthly Basis&#39;</span><span class="p">,</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/comments_bjp_monthly.png" width="80%"></p>
<div class="highlight"><pre><span></span><span class="n">comment_lengths</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select </span>
<span class="s2">        month, count </span>
<span class="s2">    from (</span>
<span class="s2">        select </span>
<span class="s2">            date(posted_at, &#39;start of month&#39;) as month, </span>
<span class="s2">            count(*) as count, sum(score) as score, </span>
<span class="s2">            b64decode(content) as b64comment </span>
<span class="s2">        from comments </span>
<span class="s2">        where b64comment!=&#39;&#39; and (</span>
<span class="s2">            (b64comment LIKE &#39;</span><span class="si">%a</span><span class="s2">ap%&#39;) or (b64comment LIKE &#39;</span><span class="si">%a</span><span class="s2">admi%&#39;) or </span>
<span class="s2">            (b64comment LIKE &#39;%kejri%&#39;) or (b64comment LIKE &#39;%kejriwal%&#39;)) </span>
<span class="s2">        group by month)&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span> <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Number of comments referring to Kejriwal or AAP on a Monthly Basis&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/comments_aap_monthly.png" width="80%"></p>
<p>We looked at number of submissions and comments across different time periods but can we find some signal in the length of the comment? If at all there are paid accounts, what are they measured on? Could it be length of the comment? If so we should see quite a lot of long comments or comments over certain length. So let's see...</p>
<div class="highlight"><pre><span></span><span class="n">comment_lengths</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select </span>
<span class="s2">        comment_length, count(*) as count </span>
<span class="s2">    from (</span>
<span class="s2">        select </span>
<span class="s2">            length(content) as comment_length </span>
<span class="s2">        from comments where content!=&#39;&#39;) </span>
<span class="s2">    group by comment_length </span>
<span class="s2">    order by comment_length asc limit 100&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_lengths</span><span class="p">],</span> 
          <span class="s1">&#39;Length of comment&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Histogram of length of all the comments&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/histogram_length_comments.png" width="80%"></p>
<p>It turns out that other than a spike at length of comment between 10 and 15, nothing else stands out. Let's see what's the case with those specific comments of length between 10 and 15 by constructing a word cloud of those comments.</p>
<div class="highlight"><pre><span></span><span class="c1"># Submission text word cloud</span>
<span class="n">submission_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">b64text</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select content from comments</span>
<span class="s2">    where content!=&#39;&#39; and length(content)&gt;10 and length(content)&lt;15&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64text</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">submission_text</span> <span class="o">+=</span> <span class="n">text</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
<span class="n">text_wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">submission_text</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">text_wordcloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Wordcloud of Political Submission Content&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>


<p>Output:</p>
<div class="highlight"><pre><span></span>(-0.5, 1199.5, 599.5, -0.5)
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/wordcloud_political_submission.png" width="80%"></p>
<p>Well, looks like most of those comments are 'removed', 'deleted', etc., unrelated to the discussion at hand. I guess, if paid accounts exist, they are definitely not paid by the length of their comments. It did match my intuition but its not a big deal to validate it.</p>
<h2>Submission Authors and their Activity</h2>
<p>Focusing on general user activity didn't lead to any information that makes it easy to identify paid accounts. Let's try focusing on authors who posted most submissions. We can look at authors based on their submissions or the score that they received. Below is the list of authors with highest political submissions and scores.</p>
<div class="highlight"><pre><span></span><span class="c1"># Most frequent political submission authors</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select posted_by, count(*) as count </span>
<span class="s2">    from submissions </span>
<span class="s2">    where link_flair_text==&#39;Politics&#39; </span>
<span class="s2">    group by posted_by order by count desc&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> 
        <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Username&#39;</span><span class="p">,</span> <span class="s1">&#39;Submissions&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)))</span>
</pre></div>


<table>
<thead>
<tr>
<th>Username</th>
<th>Submissions</th>
</tr>
</thead>
<tbody>
<tr>
<td>swacchreddit</td>
<td>330</td>
</tr>
<tr>
<td>gcs8</td>
<td>261</td>
</tr>
<tr>
<td>modiusoperandi</td>
<td>249</td>
</tr>
<tr>
<td>pannagasamir</td>
<td>229</td>
</tr>
<tr>
<td>hipporama</td>
<td>203</td>
</tr>
<tr>
<td>pure_haze</td>
<td>189</td>
</tr>
<tr>
<td>TemptNotTheBlade</td>
<td>173</td>
</tr>
<tr>
<td>aryaninvader</td>
<td>163</td>
</tr>
<tr>
<td>ajfben</td>
<td>153</td>
</tr>
<tr>
<td>darklordind</td>
<td>145</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><span class="c1"># Most popular (based on score) political submission authors</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select posted_by, sum(score) as score </span>
<span class="s2">    from submissions </span>
<span class="s2">    group by posted_by order by score desc&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">11</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> 
        <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Username&#39;</span><span class="p">,</span> <span class="s1">&#39;Submission Score&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)))</span>
</pre></div>


<table>
<thead>
<tr>
<th>Username</th>
<th>Submission Score</th>
</tr>
</thead>
<tbody>
<tr>
<td>hipporama</td>
<td>43363</td>
</tr>
<tr>
<td>pannagasamir</td>
<td>34396</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>28209</td>
</tr>
<tr>
<td>aryaninvader</td>
<td>26022</td>
</tr>
<tr>
<td>TemptNotTheBlade</td>
<td>22450</td>
</tr>
<tr>
<td>gcs8</td>
<td>22383</td>
</tr>
<tr>
<td>ironypatrol</td>
<td>21829</td>
</tr>
<tr>
<td>modiusoperandi</td>
<td>21447</td>
</tr>
<tr>
<td>spikyraccoon</td>
<td>19153</td>
</tr>
<tr>
<td>ab0mI</td>
<td>17806</td>
</tr>
</tbody>
</table>
<h2>Author Affinity</h2>
<p>Could any of the above identified accounts have secondary accounts that they use to push up their submissions? Secondary accounts are the ones whose sole purpose is to upvote, comment or respond to authors posts to give an impression that the post is seeing more activity than it actually does. Unfortunately, Reddit doesn't share upvote/downvote information so we are left with looking at who responded to whom. In order to make this analysis easier, I came up with Author Affinity Score. Basically, for every author A, we try to identify proportion of responses that an author B received from A. If A responds solely to B, it could be that A is a secondary account of B. To put it mathematically,</p>
<div class="highlight"><pre><span></span><span class="n">Author</span> <span class="n">Affinity</span> <span class="n">of</span> <span class="n">A</span> <span class="n">to</span> <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">Number</span> <span class="n">of</span> <span class="n">responses</span> <span class="n">of</span> <span class="n">Author</span> <span class="n">A</span> <span class="n">to</span> <span class="n">Author</span> <span class="n">B</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Number</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">responses</span> <span class="n">of</span> <span class="n">Author</span> <span class="n">A</span><span class="p">)</span>
</pre></div>


<p>We look at the distribution of author affinity score to see if we can see some patterns. Please note that this information is not necessarily conclusive as there could be some accounts that were created just to participate in certain threads and never used again. It doesn't imply that the account is related to the author. However, it is interesting to note that there are quite a few accounts like that.</p>
<p>I apologize about long SQL queries from here onwards. As you can see, these queries are really complicated and it is hard for me to understand them fully unless I indent them properly.</p>
<div class="highlight"><pre><span></span><span class="c1"># Secondary accounts</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select (max_specific_response*1.0/total_responses) as author_affinity,</span>
<span class="s2">        count(*) as count </span>
<span class="s2">    from</span>
<span class="s2">        (select</span>
<span class="s2">            comments.posted_by,</span>
<span class="s2">            count(*) as total_responses </span>
<span class="s2">        from</span>
<span class="s2">            comments </span>
<span class="s2">        join</span>
<span class="s2">            submissions </span>
<span class="s2">                on comments.submission_id==submissions.submission_id </span>
<span class="s2">        group by</span>
<span class="s2">            comments.posted_by) </span>
<span class="s2">    join</span>
<span class="s2">        (</span>
<span class="s2">            select</span>
<span class="s2">                c_posted_by,</span>
<span class="s2">                max(specific_responses) as max_specific_response </span>
<span class="s2">            from</span>
<span class="s2">                (select</span>
<span class="s2">                    comments.posted_by as c_posted_by,</span>
<span class="s2">                    (comments.posted_by||submissions.posted_by) as pair,</span>
<span class="s2">                    count(*) as specific_responses </span>
<span class="s2">                from</span>
<span class="s2">                    comments </span>
<span class="s2">                join</span>
<span class="s2">                    submissions </span>
<span class="s2">                        on comments.submission_id==submissions.submission_id </span>
<span class="s2">                        and comments.posted_by!=submissions.posted_by </span>
<span class="s2">                group by</span>
<span class="s2">                    pair) </span>
<span class="s2">            group by</span>
<span class="s2">                c_posted_by) </span>
<span class="s2">                    on posted_by==c_posted_by </span>
<span class="s2">            where</span>
<span class="s2">                total_responses &gt; 10 </span>
<span class="s2">            group by</span>
<span class="s2">                author_affinity</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">data</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">data</span><span class="p">],</span> 
          <span class="s1">&#39;Author Affinity score&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of Comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Affinity of an author to another specific author&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/author_affinity.png" width="80%"></p>
<p>Now, lets look at accounts which have a strong affinity to an author and made large number of comments. If an account made few comments and has strong affinity, we can consider that as a one-off account to respond. However, if an account has large number of submissions and still has strong affinity to an author, that's definitely a reason to be suspicious about. And we have quite a few such accounts. Some of these accounts are obviously secondary accounts. For ex., "RahulRamIO" and "NikhilRaoIO" are most probably secondary accounts. Is there an actual parent account that owns all these? We don't know yet. It needs much more investigation.</p>
<div class="highlight"><pre><span></span><span class="c1"># Affinity of authors sorted by affinity score and total responses</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select posted_by,</span>
<span class="s2">        total_responses,</span>
<span class="s2">        s_posted_by,</span>
<span class="s2">        max_specific_response,</span>
<span class="s2">        (max_specific_response*1.0/total_responses) as author_affinity </span>
<span class="s2">    from</span>
<span class="s2">        (select</span>
<span class="s2">            comments.posted_by,</span>
<span class="s2">            count(*) as total_responses </span>
<span class="s2">        from</span>
<span class="s2">            comments </span>
<span class="s2">        join</span>
<span class="s2">            submissions </span>
<span class="s2">                on comments.submission_id==submissions.submission_id </span>
<span class="s2">        group by</span>
<span class="s2">            comments.posted_by) </span>
<span class="s2">    join</span>
<span class="s2">        (</span>
<span class="s2">            select</span>
<span class="s2">                c_posted_by,</span>
<span class="s2">                s_posted_by,</span>
<span class="s2">                max(specific_responses) as max_specific_response </span>
<span class="s2">            from</span>
<span class="s2">                (select</span>
<span class="s2">                    comments.posted_by as c_posted_by,</span>
<span class="s2">                    submissions.posted_by as s_posted_by,</span>
<span class="s2">                    (comments.posted_by||submissions.posted_by) as pair,</span>
<span class="s2">                    count(*) as specific_responses </span>
<span class="s2">                from</span>
<span class="s2">                    comments </span>
<span class="s2">                join</span>
<span class="s2">                    submissions </span>
<span class="s2">                        on comments.submission_id==submissions.submission_id </span>
<span class="s2">                        and comments.posted_by!=submissions.posted_by </span>
<span class="s2">                group by</span>
<span class="s2">                    pair) </span>
<span class="s2">            group by</span>
<span class="s2">                c_posted_by) </span>
<span class="s2">                    on posted_by==c_posted_by </span>
<span class="s2">            where</span>
<span class="s2">                total_responses&gt;1 </span>
<span class="s2">            order by</span>
<span class="s2">                author_affinity desc,</span>
<span class="s2">                total_responses desc&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> 
        <span class="n">headers</span><span class="o">=</span><span class="p">[</span>
            <span class="s1">&#39;Comment Author&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Comments&#39;</span><span class="p">,</span> <span class="s1">&#39;Submission Author&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Responses&#39;</span><span class="p">,</span> <span class="s1">&#39;Author Affinity&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)))</span>
</pre></div>


<table>
<thead>
<tr>
<th>Comment Author</th>
<th>Total Comments</th>
<th>Submission Author</th>
<th>Responses</th>
<th>Author Affinity</th>
</tr>
</thead>
<tbody>
<tr>
<td>doGrmoctidder</td>
<td>87</td>
<td>notmuchhere_carryon</td>
<td>87</td>
<td>1</td>
</tr>
<tr>
<td>RahulRamIO</td>
<td>37</td>
<td>NikhilRaoIO</td>
<td>37</td>
<td>1</td>
</tr>
<tr>
<td>ashwinskumar</td>
<td>34</td>
<td>theunrealtimes</td>
<td>34</td>
<td>1</td>
</tr>
<tr>
<td>rajkummar_r</td>
<td>33</td>
<td>vikramaditya_m</td>
<td>33</td>
<td>1</td>
</tr>
<tr>
<td>Bu-D-Yo-Eve-Lift</td>
<td>30</td>
<td>[deleted]</td>
<td>30</td>
<td>1</td>
</tr>
<tr>
<td>monkey_sage</td>
<td>28</td>
<td>Devam13</td>
<td>28</td>
<td>1</td>
</tr>
<tr>
<td>Leoelement02</td>
<td>26</td>
<td>so_mindfucked</td>
<td>26</td>
<td>1</td>
</tr>
<tr>
<td>D3MON130</td>
<td>21</td>
<td>Millicent_Bystandard</td>
<td>21</td>
<td>1</td>
</tr>
<tr>
<td>hatebreeder69</td>
<td>19</td>
<td>notmuchhere_carryon</td>
<td>19</td>
<td>1</td>
</tr>
<tr>
<td>verylateish</td>
<td>19</td>
<td>so_mindfucked</td>
<td>19</td>
<td>1</td>
</tr>
<tr>
<td>ThatGuyGaren</td>
<td>16</td>
<td>rajutek</td>
<td>16</td>
<td>1</td>
</tr>
<tr>
<td>aniruddhdodiya</td>
<td>16</td>
<td>N-Mag</td>
<td>16</td>
<td>1</td>
</tr>
<tr>
<td>boobanies1234</td>
<td>16</td>
<td>saptarsi</td>
<td>16</td>
<td>1</td>
</tr>
<tr>
<td>paramour_u</td>
<td>16</td>
<td>thewire_in</td>
<td>16</td>
<td>1</td>
</tr>
<tr>
<td>91JustCurious</td>
<td>15</td>
<td>backFromTheBed</td>
<td>15</td>
<td>1</td>
</tr>
<tr>
<td>barebearbeard</td>
<td>15</td>
<td>Devam13</td>
<td>15</td>
<td>1</td>
</tr>
<tr>
<td>vidyavolks</td>
<td>15</td>
<td>eve2k17</td>
<td>15</td>
<td>1</td>
</tr>
<tr>
<td>weneedtofederalize</td>
<td>14</td>
<td>so_mindfucked</td>
<td>14</td>
<td>1</td>
</tr>
<tr>
<td>wubbalubbaeatadick</td>
<td>13</td>
<td>awkwardpile</td>
<td>13</td>
<td>1</td>
</tr>
<tr>
<td>CrazedZombie</td>
<td>12</td>
<td>rajutek</td>
<td>12</td>
<td>1</td>
</tr>
<tr>
<td>Ni-li</td>
<td>12</td>
<td>oxeam</td>
<td>12</td>
<td>1</td>
</tr>
<tr>
<td>firenhammer</td>
<td>12</td>
<td>sanskaridaddy</td>
<td>12</td>
<td>1</td>
</tr>
<tr>
<td>statelessnfaithless</td>
<td>12</td>
<td>japanese_kuhukuhu</td>
<td>12</td>
<td>1</td>
</tr>
<tr>
<td>stealtho</td>
<td>12</td>
<td>jrulz254</td>
<td>12</td>
<td>1</td>
</tr>
<tr>
<td>venkrish</td>
<td>12</td>
<td>throwawayindia11</td>
<td>12</td>
<td>1</td>
</tr>
<tr>
<td>wingdbullet</td>
<td>12</td>
<td>Rpittrer</td>
<td>12</td>
<td>1</td>
</tr>
<tr>
<td>AbhijeetBarse</td>
<td>11</td>
<td>abhishekiyer</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>Luk-SpringWalker</td>
<td>11</td>
<td>Pygnus</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>ThrottleMunky</td>
<td>11</td>
<td>prawncream</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>amrams</td>
<td>11</td>
<td>saptarsi</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>modomario</td>
<td>11</td>
<td>so_mindfucked</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>poetrytadka</td>
<td>11</td>
<td>thrownwa</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>shakeeshakee</td>
<td>11</td>
<td>stoikrus1</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>vimalnair</td>
<td>11</td>
<td>eve2k17</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>vineetr</td>
<td>11</td>
<td>redweddingsareawesom</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>Ant-Climax</td>
<td>10</td>
<td>SB-bhakt</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>CaptainBoomrang</td>
<td>10</td>
<td>SoulsBorNioh</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>DivyDubey</td>
<td>10</td>
<td>[deleted]</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>FranciscoEverywhere</td>
<td>10</td>
<td>Devam13</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>TheAsteroid</td>
<td>10</td>
<td>notmuchhere_carryon</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>chin-ke-glasses</td>
<td>10</td>
<td>so_mindfucked</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>ePi7</td>
<td>10</td>
<td>aucolgera</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>hexalby</td>
<td>10</td>
<td>so_mindfucked</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>lordpimba</td>
<td>10</td>
<td>Pygnus</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>mapzv</td>
<td>10</td>
<td>pysthrwaway</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>sreyatheresa</td>
<td>10</td>
<td>eve2k17</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>thairsadam</td>
<td>10</td>
<td>balamz</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>vivek1982</td>
<td>10</td>
<td>NikhilRaoIO</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>Apiperofhades</td>
<td>9</td>
<td>HarrySeverusPotter</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>Mascatuercas</td>
<td>9</td>
<td>so_mindfucked</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>Mina-Harad</td>
<td>9</td>
<td>prawncream</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>MrBoonio</td>
<td>9</td>
<td>so_mindfucked</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>Some_Random_Nob</td>
<td>9</td>
<td>aphnx</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>devGRASS</td>
<td>9</td>
<td>aeborn_man</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>mik-1</td>
<td>9</td>
<td>saptarsi</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>peculiarblend</td>
<td>9</td>
<td>doc_two_thirty</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>sauputt</td>
<td>9</td>
<td>anon_geek</td>
<td>9</td>
<td>1</td>
</tr>
<tr>
<td>ECWS</td>
<td>8</td>
<td>burdeamit</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>HSBCIndia</td>
<td>8</td>
<td>gatechguy</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>Hohenes</td>
<td>8</td>
<td>so_mindfucked</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>LawDallason</td>
<td>8</td>
<td>oxeam</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>Warlizard</td>
<td>8</td>
<td>mean_median</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>ZippyDan</td>
<td>8</td>
<td>spikyraccoon</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>chah-pohe</td>
<td>8</td>
<td>avinassh</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>dasoberirishman</td>
<td>8</td>
<td>Devam13</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>ollywollypollywoggy</td>
<td>8</td>
<td>Devam13</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>oreng</td>
<td>8</td>
<td>TheAustroHungarian1</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>thegoodbadandsmoggy</td>
<td>8</td>
<td>iNotRobot</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>zzzzzzzzzzzzzzzzspaf</td>
<td>8</td>
<td>so_mindfucked</td>
<td>8</td>
<td>1</td>
</tr>
<tr>
<td>Afteraffekt</td>
<td>7</td>
<td>RealPhiLee</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>Arnorien16</td>
<td>7</td>
<td>prateek_gosh</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>AuswinGThomas</td>
<td>7</td>
<td>notmuchhere_carryon</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>BamboDaClown</td>
<td>7</td>
<td>Sid_da_bomb</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>Blaxrobe</td>
<td>7</td>
<td>Devam13</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>Elvaga</td>
<td>7</td>
<td>Pygnus</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>IndiaIsSaffron</td>
<td>7</td>
<td>notmuchhere_carryon</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>KaroshiNakamoto</td>
<td>7</td>
<td>saptarsi</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>Lucas_Berse</td>
<td>7</td>
<td>Pygnus</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>NewsForThePaperGod</td>
<td>7</td>
<td>notmuchhere_carryon</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>Penk</td>
<td>- 7</td>
<td>so_mindfucked</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>Pmbreddit</td>
<td>7</td>
<td>parvdave</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>ScamJamSlam</td>
<td>7</td>
<td>saptarsi</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>amalthebear</td>
<td>7</td>
<td>john2a</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>aut1sticalex</td>
<td>7</td>
<td>peopledontlikemypost</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>dudegrt</td>
<td>7</td>
<td>asherkosaraju</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>elcrankopunko</td>
<td>7</td>
<td>anon_geek</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>jangood</td>
<td>7</td>
<td>threedotsguy</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>kj_venom11</td>
<td>7</td>
<td>backFromTheBed</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>madboy1995</td>
<td>7</td>
<td>sunil24</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>mbok_jamu</td>
<td>7</td>
<td>Devam13</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>nibbler97</td>
<td>7</td>
<td>spikyraccoon</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>over9E3</td>
<td>7</td>
<td>justamomentbee</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>ppatra_ka_Jijaji</td>
<td>7</td>
<td>ppatra</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>realisticview</td>
<td>7</td>
<td>AvianSlam</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>sakht_launda</td>
<td>7</td>
<td>backFromTheBed</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>samarhalarnkar</td>
<td>7</td>
<td>govindrajethiraj</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>spl0i7</td>
<td>7</td>
<td>avinassh</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>throwawayredac11</td>
<td>7</td>
<td>throwawayredac1</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>xingfenzhen</td>
<td>7</td>
<td>so_mindfucked</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>AQKhan786</td>
<td>6</td>
<td>TragedyOfAClown</td>
<td>6</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2>Author Affinity and Average Time to Respond</h2>
<p>We have quite a lot of accounts with high author affinity score. If these accounts are indeed used for pushing up a submission to earn that sweet karma, we can look at the average time to respond as an indicator. For all the probable secondary accounts identified so far, lets also include the average time to respond to the original accounts submission. For this, we are only considering accounts that made more than one submission. This excludes one-off accounts that bias the results.</p>
<div class="highlight"><pre><span></span><span class="c1"># Secondary account count of different authors based on affinity score</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select s_posted_by,</span>
<span class="s2">        count(*) as count,</span>
<span class="s2">        avg(avg_timediff) as avg_avg_timediff</span>
<span class="s2">    from</span>
<span class="s2">        (select</span>
<span class="s2">            s_posted_by,</span>
<span class="s2">            posted_by,</span>
<span class="s2">            (max_specific_response*1.0/total_responses) as author_affinity,</span>
<span class="s2">            avg_timediff</span>
<span class="s2">        from</span>
<span class="s2">            (select</span>
<span class="s2">                comments.posted_by,</span>
<span class="s2">                count(*) as total_responses,</span>
<span class="s2">                avg((</span>
<span class="s2">                    cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, comments.posted_at) as integer) -</span>
<span class="s2">                    cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, submissions.posted_at) as integer))/60) as avg_timediff             </span>
<span class="s2">            from</span>
<span class="s2">                comments</span>
<span class="s2">            join</span>
<span class="s2">                submissions </span>
<span class="s2">                    on comments.submission_id==submissions.submission_id              </span>
<span class="s2">            group by</span>
<span class="s2">                comments.posted_by)      </span>
<span class="s2">        join</span>
<span class="s2">            (</span>
<span class="s2">                select</span>
<span class="s2">                    c_posted_by,</span>
<span class="s2">                    s_posted_by,</span>
<span class="s2">                    max(specific_responses) as max_specific_response          </span>
<span class="s2">                from</span>
<span class="s2">                    (select</span>
<span class="s2">                        comments.posted_by as c_posted_by,</span>
<span class="s2">                        submissions.posted_by as s_posted_by,</span>
<span class="s2">                        (comments.posted_by||submissions.posted_by) as pair,</span>
<span class="s2">                        count(*) as specific_responses              </span>
<span class="s2">                    from</span>
<span class="s2">                        comments              </span>
<span class="s2">                    join</span>
<span class="s2">                        submissions </span>
<span class="s2">                            on comments.submission_id==submissions.submission_id              </span>
<span class="s2">                    where</span>
<span class="s2">                        comments.posted_by!=submissions.posted_by              </span>
<span class="s2">                    group by</span>
<span class="s2">                        pair)          </span>
<span class="s2">                group by</span>
<span class="s2">                    c_posted_by)          </span>
<span class="s2">                        on posted_by==c_posted_by          </span>
<span class="s2">                where</span>
<span class="s2">                    total_responses&gt;1</span>
<span class="s2">            )  </span>
<span class="s2">        where</span>
<span class="s2">            author_affinity &gt; 0.9  </span>
<span class="s2">        group by</span>
<span class="s2">            s_posted_by  </span>
<span class="s2">        order by</span>
<span class="s2">            count desc</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> 
        <span class="n">headers</span><span class="o">=</span><span class="p">[</span>
            <span class="s1">&#39;Submission Poster&#39;</span><span class="p">,</span> <span class="s1">&#39;Probable Secondary Accounts&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;Avg time to respond in mins&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)))</span>
</pre></div>


<table>
<thead>
<tr>
<th>Submission Poster</th>
<th>Probable Secondary Accounts</th>
<th>Avg time to respond</th>
</tr>
</thead>
<tbody>
<tr>
<td>so_mindfucked</td>
<td>76</td>
<td>2636.49</td>
</tr>
<tr>
<td>Devam13</td>
<td>63</td>
<td>2452.89</td>
</tr>
<tr>
<td>[deleted]</td>
<td>61</td>
<td>1762.73</td>
</tr>
<tr>
<td>spikyraccoon</td>
<td>47</td>
<td>704.677</td>
</tr>
<tr>
<td>notmuchhere_carryon</td>
<td>40</td>
<td>1772.21</td>
</tr>
<tr>
<td>Pygnus</td>
<td>39</td>
<td>580.256</td>
</tr>
<tr>
<td>avinassh</td>
<td>39</td>
<td>3287.31</td>
</tr>
<tr>
<td>doc_two_thirty</td>
<td>28</td>
<td>871.147</td>
</tr>
<tr>
<td>saptarsi</td>
<td>27</td>
<td>1391.25</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>20</td>
<td>610.322</td>
</tr>
<tr>
<td>backFromTheBed</td>
<td>19</td>
<td>1330.52</td>
</tr>
<tr>
<td>RealPhiLee</td>
<td>17</td>
<td>993.681</td>
</tr>
<tr>
<td>rajutek</td>
<td>16</td>
<td>1196.14</td>
</tr>
<tr>
<td>ppatra</td>
<td>15</td>
<td>13633.7</td>
</tr>
<tr>
<td>oxeam</td>
<td>14</td>
<td>6533.38</td>
</tr>
<tr>
<td>ARflash</td>
<td>13</td>
<td>2290.14</td>
</tr>
<tr>
<td>Thisisbhusha</td>
<td>11</td>
<td>6281.81</td>
</tr>
<tr>
<td>cool_boyy</td>
<td>10</td>
<td>1855.47</td>
</tr>
<tr>
<td>prawncream</td>
<td>10</td>
<td>559.791</td>
</tr>
<tr>
<td>OnePunchSenpai</td>
<td>9</td>
<td>829.509</td>
</tr>
<tr>
<td>Lotus_towers</td>
<td>8</td>
<td>452.038</td>
</tr>
<tr>
<td><em>why_so_sirious</em></td>
<td>8</td>
<td>2595.46</td>
</tr>
<tr>
<td>anon_geek</td>
<td>8</td>
<td>3969.31</td>
</tr>
<tr>
<td>goenkasandeep</td>
<td>8</td>
<td>543.717</td>
</tr>
<tr>
<td>ironypatrol</td>
<td>8</td>
<td>7289.61</td>
</tr>
<tr>
<td>parvaaz</td>
<td>8</td>
<td>76.2778</td>
</tr>
<tr>
<td>parvdave</td>
<td>8</td>
<td>299.729</td>
</tr>
<tr>
<td>thelonesomeguy</td>
<td>8</td>
<td>15540.6</td>
</tr>
<tr>
<td>vikramaditya_m</td>
<td>8</td>
<td>33.9341</td>
</tr>
<tr>
<td>yal_sik</td>
<td>8</td>
<td>1972.27</td>
</tr>
<tr>
<td>BharatiyaNagarik</td>
<td>7</td>
<td>563.536</td>
</tr>
<tr>
<td>SanskariNari</td>
<td>7</td>
<td>575.333</td>
</tr>
<tr>
<td>bhogle-harsha</td>
<td>7</td>
<td>116.929</td>
</tr>
<tr>
<td>hipporama</td>
<td>7</td>
<td>540.524</td>
</tr>
<tr>
<td>hoezaaay</td>
<td>7</td>
<td>53.0476</td>
</tr>
<tr>
<td>i_am_not_sam</td>
<td>7</td>
<td>1516.68</td>
</tr>
<tr>
<td>pannagasamir</td>
<td>7</td>
<td>747.429</td>
</tr>
<tr>
<td>root_su</td>
<td>7</td>
<td>730.19</td>
</tr>
<tr>
<td>shashitharoor2017</td>
<td>7</td>
<td>145.786</td>
</tr>
<tr>
<td>Keerikkadan91</td>
<td>6</td>
<td>991.525</td>
</tr>
<tr>
<td>NikhilRaoIO</td>
<td>6</td>
<td>64.5099</td>
</tr>
<tr>
<td>arrangedmarriagescar</td>
<td>6</td>
<td>2865.94</td>
</tr>
<tr>
<td>indifferentoyou</td>
<td>6</td>
<td>1037.99</td>
</tr>
<tr>
<td>majorwtf</td>
<td>6</td>
<td>501.389</td>
</tr>
<tr>
<td>rex_trillerson</td>
<td>6</td>
<td>670.5</td>
</tr>
<tr>
<td>1975edbyreddit</td>
<td>5</td>
<td>1217.82</td>
</tr>
<tr>
<td>aryaninvader</td>
<td>5</td>
<td>1099.99</td>
</tr>
<tr>
<td>in3po</td>
<td>5</td>
<td>602.3</td>
</tr>
<tr>
<td>in3xorabl3</td>
<td>5</td>
<td>1996.59</td>
</tr>
<tr>
<td>ponniyin_selvan</td>
<td>5</td>
<td>1410.22</td>
</tr>
<tr>
<td>ribiy</td>
<td>5</td>
<td>1265.4</td>
</tr>
<tr>
<td>theunrealtimes</td>
<td>5</td>
<td>31.8725</td>
</tr>
<tr>
<td>yogesh_calm</td>
<td>5</td>
<td>3790.1</td>
</tr>
<tr>
<td>2EyedRaven</td>
<td>4</td>
<td>21241.1</td>
</tr>
<tr>
<td>ENTKulcha</td>
<td>4</td>
<td>1510.77</td>
</tr>
<tr>
<td>Gyanam</td>
<td>4</td>
<td>5246.83</td>
</tr>
<tr>
<td>Kulcha__Warrior</td>
<td>4</td>
<td>4973.83</td>
</tr>
<tr>
<td>Phuc-Dat_Bich</td>
<td>4</td>
<td>392.708</td>
</tr>
<tr>
<td>Saigo_Digiart</td>
<td>4</td>
<td>332.042</td>
</tr>
<tr>
<td>Sykik165</td>
<td>4</td>
<td>496.7</td>
</tr>
<tr>
<td>Voiceofstray</td>
<td>4</td>
<td>1334.25</td>
</tr>
<tr>
<td>YouKiddin</td>
<td>4</td>
<td>1180.21</td>
</tr>
<tr>
<td>_dexter</td>
<td>4</td>
<td>1530.12</td>
</tr>
<tr>
<td>aucolgera</td>
<td>4</td>
<td>659.125</td>
</tr>
<tr>
<td>babbanbhai</td>
<td>4</td>
<td>722.833</td>
</tr>
<tr>
<td>bad_joke_maker</td>
<td>4</td>
<td>632.458</td>
</tr>
<tr>
<td>dopamine86</td>
<td>4</td>
<td>949</td>
</tr>
<tr>
<td>eve2k17</td>
<td>4</td>
<td>13.4826</td>
</tr>
<tr>
<td>lallulal</td>
<td>4</td>
<td>1054.25</td>
</tr>
<tr>
<td>modiusoperandi</td>
<td>4</td>
<td>523.625</td>
</tr>
<tr>
<td>nuclearpowerwalah</td>
<td>4</td>
<td>1949.25</td>
</tr>
<tr>
<td>redindian92</td>
<td>4</td>
<td>325.25</td>
</tr>
<tr>
<td>sIlentr3b3l</td>
<td>4</td>
<td>746.375</td>
</tr>
<tr>
<td>shashi_sah</td>
<td>4</td>
<td>4900.42</td>
</tr>
<tr>
<td>sorry_shaktimaan</td>
<td>4</td>
<td>565.125</td>
</tr>
<tr>
<td>start123</td>
<td>4</td>
<td>686.792</td>
</tr>
<tr>
<td>unknown-indian</td>
<td>4</td>
<td>1326.27</td>
</tr>
<tr>
<td>vinodis</td>
<td>4</td>
<td>269.708</td>
</tr>
<tr>
<td>z921</td>
<td>4</td>
<td>2087.42</td>
</tr>
<tr>
<td>-0-1-</td>
<td>3</td>
<td>6725.67</td>
</tr>
<tr>
<td>47884375</td>
<td>3</td>
<td>625.667</td>
</tr>
<tr>
<td>AAPkeMoohMe</td>
<td>3</td>
<td>487.25</td>
</tr>
<tr>
<td>Aamraswala</td>
<td>3</td>
<td>410.5</td>
</tr>
<tr>
<td>Abzone7n</td>
<td>3</td>
<td>1894.5</td>
</tr>
<tr>
<td>AvianSlam</td>
<td>3</td>
<td>18878.4</td>
</tr>
<tr>
<td>Chutiyapaconnoisseur</td>
<td>3</td>
<td>9667.33</td>
</tr>
<tr>
<td>HarrySeverusPotter</td>
<td>3</td>
<td>574.685</td>
</tr>
<tr>
<td>HornOK</td>
<td>3</td>
<td>598.333</td>
</tr>
<tr>
<td>Improctor</td>
<td>3</td>
<td>4672.5</td>
</tr>
<tr>
<td>LOLR556</td>
<td>3</td>
<td>3692.33</td>
</tr>
<tr>
<td>SD548</td>
<td>3</td>
<td>1893.91</td>
</tr>
<tr>
<td>TheAustroHungarian1</td>
<td>3</td>
<td>903.125</td>
</tr>
<tr>
<td><em>0110111001101111</em></td>
<td>3</td>
<td>347.833</td>
</tr>
<tr>
<td>aham_brahmasmi</td>
<td>3</td>
<td>1189.83</td>
</tr>
<tr>
<td>baba_ranchoddas</td>
<td>3</td>
<td>330.056</td>
</tr>
<tr>
<td>bathroomsinger</td>
<td>3</td>
<td>106435</td>
</tr>
<tr>
<td>dhakkarnia</td>
<td>3</td>
<td>885.444</td>
</tr>
<tr>
<td>dodunichaar</td>
<td>3</td>
<td>1049.83</td>
</tr>
<tr>
<td>ghatroad</td>
<td>3</td>
<td>400</td>
</tr>
<tr>
<td>hedButt</td>
<td>3</td>
<td>761.222</td>
</tr>
</tbody>
</table>
<p>Well, that doesn't make sense. If someone created so many secondary accounts, one would assume that they would respond soon after the submission was made. However, what we see here is that the secondary accounts usually respond few hours AFTER the submission. Sometimes even after couple of days. Why would that be? Is it because someone is using these secondary accounts only to ensure that the discussion continues and that the submission stays longer on the front-page? Before we answer that, lets look at a specific author and his secondary accounts so we have a better idea of what we are looking at. Some of the accounts identified above are moderators and there were some AMAs and Cultural Exchange threads so their secondary accounts can be explained that way. I picked a non-mod author with large number of secondary accounts and with low time to respond, just as an example. That lucky author turned out to be "wordswithmagic".</p>
<div class="highlight"><pre><span></span><span class="c1"># Secondary account count of different authors based on affinity score</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select </span>
<span class="s2">        s_posted_by, posted_by, total_responses, max_specific_response, </span>
<span class="s2">        author_affinity, avg_timediff      </span>
<span class="s2">    from</span>
<span class="s2">        (select</span>
<span class="s2">            s_posted_by,</span>
<span class="s2">            posted_by,</span>
<span class="s2">            total_responses,</span>
<span class="s2">            max_specific_response,</span>
<span class="s2">            (max_specific_response*1.0/total_responses) as author_affinity,</span>
<span class="s2">            avg_timediff </span>
<span class="s2">        from</span>
<span class="s2">            (select</span>
<span class="s2">                comments.posted_by,</span>
<span class="s2">                count(*) as total_responses,</span>
<span class="s2">                avg((</span>
<span class="s2">                    cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, comments.posted_at) as integer) -</span>
<span class="s2">                    cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, submissions.posted_at) as integer))/60) as avg_timediff              </span>
<span class="s2">            from</span>
<span class="s2">                comments              </span>
<span class="s2">            join</span>
<span class="s2">                submissions </span>
<span class="s2">                    on comments.submission_id==submissions.submission_id              </span>
<span class="s2">            group by</span>
<span class="s2">                comments.posted_by)          </span>
<span class="s2">        join</span>
<span class="s2">            (</span>
<span class="s2">                select</span>
<span class="s2">                    c_posted_by,</span>
<span class="s2">                    s_posted_by,</span>
<span class="s2">                    max(specific_responses) as max_specific_response </span>
<span class="s2">                from</span>
<span class="s2">                    (select</span>
<span class="s2">                        comments.posted_by as c_posted_by,</span>
<span class="s2">                        submissions.posted_by as s_posted_by,</span>
<span class="s2">                        (comments.posted_by||submissions.posted_by) as pair,</span>
<span class="s2">                        count(*) as specific_responses                 </span>
<span class="s2">                    from</span>
<span class="s2">                        comments                  </span>
<span class="s2">                    join</span>
<span class="s2">                        submissions </span>
<span class="s2">                            on comments.submission_id==submissions.submission_id                  </span>
<span class="s2">                    where</span>
<span class="s2">                        comments.posted_by!=submissions.posted_by                 </span>
<span class="s2">                    group by</span>
<span class="s2">                        pair)              </span>
<span class="s2">                group by</span>
<span class="s2">                    c_posted_by)          </span>
<span class="s2">                        on posted_by==c_posted_by</span>
<span class="s2">                )  </span>
<span class="s2">        where</span>
<span class="s2">            s_posted_by==&#39;wordswithmagic&#39; </span>
<span class="s2">            and author_affinity &gt; 0.9 </span>
<span class="s2">            and total_responses &gt; 1  </span>
<span class="s2">        order by</span>
<span class="s2">            total_responses desc,</span>
<span class="s2">            author_affinity desc</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> 
    <span class="n">headers</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;Comment Author&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Comments&#39;</span><span class="p">,</span> <span class="s1">&#39;Submission Author&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Responses&#39;</span><span class="p">,</span> <span class="s1">&#39;Author Affinity&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg time to respond&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)))</span>
</pre></div>


<table>
<thead>
<tr>
<th>Comment Author</th>
<th>Submission Author</th>
<th>Total Comments</th>
<th>Responses</th>
<th>Author Affinity</th>
<th>Avg time to respond</th>
</tr>
</thead>
<tbody>
<tr>
<td>wordswithmagic</td>
<td>strudel-</td>
<td>5</td>
<td>5</td>
<td>1</td>
<td>436.2</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>Shiroi_Kage</td>
<td>4</td>
<td>4</td>
<td>1</td>
<td>940.75</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>euronforpresident</td>
<td>4</td>
<td>4</td>
<td>1</td>
<td>706.75</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>redstarturns</td>
<td>4</td>
<td>4</td>
<td>1</td>
<td>191.75</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>SaorAlba138</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>836</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>delusion4</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>412.333</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>fleshnbones</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>847.333</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>r3dsm0k3</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>254</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>wohho</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>528.333</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>25sittinon25cents</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>1206</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>Bodygasm</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>292.5</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>Coltonhoover</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>2083.5</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>Gustomaximus</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>627</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>Skay_4</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>389.5</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>gummz</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>233</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>ireadfaces</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>124</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>mumra71294</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>400</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>screenpoet</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>429.5</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>tiberseptim1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>724.5</td>
</tr>
<tr>
<td>wordswithmagic</td>
<td>wowmansohacked</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>543.5</td>
</tr>
</tbody>
</table>
<p>Looking at comments from a specific secondary account called 'strudel-', just to see if the comments add any value to the discussion. If they don't, it may mean that these accounts are there just to further the discussion. Well, as you can see below, it isn't clear if this is indeed secondary account of wordswithmagic. As I mentioned earlier, these are just probable secondary accounts. We need lot more data analysis to prove it conclusively that these are indeed secondary accounts of an author.</p>
<div class="highlight"><pre><span></span><span class="c1"># Secondary account count of different authors based on affinity score</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    select b64decode(content) as b64 from comments where posted_by==&#39;strudel-&#39;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Comment&#39;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)))</span>
</pre></div>


<p><strong>Comment</strong></p>
<div class="highlight"><pre><span></span><span class="nv">Just</span> <span class="nv">like</span> <span class="nv">they</span> <span class="k">do</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">US</span>. <span class="nv">http</span>:<span class="o">//</span><span class="nv">www</span>.<span class="nv">nj</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">hunterdon</span><span class="o">-</span><span class="nv">county</span><span class="o">-</span><span class="nv">democrat</span><span class="o">/</span><span class="nv">index</span>.<span class="nv">ssf</span><span class="o">/</span><span class="mi">2012</span><span class="o">/</span><span class="mi">12</span><span class="o">/</span><span class="nv">divorcee_sits_in_jail_while_ua</span>.<span class="nv">html</span> <span class="nv">Very</span> <span class="nv">common</span> <span class="nv">actually</span>. <span class="nv">https</span>:<span class="o">//</span><span class="nv">www</span>.<span class="nv">youtube</span>.<span class="nv">com</span><span class="o">/</span><span class="nv">watch</span>?<span class="nv">v</span><span class="o">=</span><span class="nv">uI80NWf7giM</span>
<span class="nv">He</span><span class="s1">&#39;</span><span class="s">s not going to answer your question, he</span><span class="s1">&#39;</span><span class="nv">s</span> <span class="nv">going</span> <span class="nv">to</span> <span class="nv">resort</span> <span class="nv">to</span> <span class="nv">baseless</span> <span class="nv">shaming</span> <span class="nv">tactics</span> <span class="nv">like</span> <span class="nv">most</span> <span class="nv">of</span> <span class="nv">these</span> <span class="nv">morons</span> <span class="k">do</span>.
<span class="nv">Depends</span>, <span class="nv">does</span> <span class="nv">her</span> <span class="nv">hand</span> <span class="nv">have</span> <span class="nv">a</span> <span class="nv">penis</span>?
<span class="k">If</span> <span class="nv">two</span> <span class="nv">people</span> <span class="nv">are</span> <span class="nv">drunk</span> <span class="nv">and</span> <span class="nv">having</span> <span class="nv">sex</span>, <span class="nv">are</span> <span class="nv">they</span> <span class="nv">raping</span> <span class="nv">eachother</span>?
<span class="nv">That</span><span class="s1">&#39;</span><span class="s">s why marriage rates are dropping drastically and people are going /r/mgtow</span>
</pre></div>


<h2>Average Active Time of a Submission</h2>
<p>If someone has secondary accounts and they are not using them to promote their submission, as we found out, they maybe using those accounts to keep the thread alive. If that's the case, active time of a submission, which is the time difference between when the submission is made and the last comment is made, should be the one that is being gamed. This ensures that visitors to the subreddit see the submission for much longer than they would have otherwise. So let's see if there is a pattern here...</p>
<div class="highlight"><pre><span></span><span class="n">comment_diffs</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select active_time, count(*)</span>
<span class="s2">from</span>
<span class="s2">    (select submission_id, max(timediff) as active_time</span>
<span class="s2">    from</span>
<span class="s2">        (select </span>
<span class="s2">            d.posted_by, c.submission_id, </span>
<span class="s2">            (</span>
<span class="s2">                cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, c.posted_at) as integer) - </span>
<span class="s2">                cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, d.posted_at) as integer)</span>
<span class="s2">            )/60 as timediff</span>
<span class="s2">        from</span>
<span class="s2">            comments as c </span>
<span class="s2">        join</span>
<span class="s2">            submissions as d on c.submission_id==d.submission_id</span>
<span class="s2">        where</span>
<span class="s2">            c.posted_by!=&#39;AutoModerator&#39; </span>
<span class="s2">            and c.posted_by NOT LIKE &#39;%bot&#39; </span>
<span class="s2">            and c.posted_by!=&#39;[deleted]&#39;)</span>
<span class="s2">    group by</span>
<span class="s2">    submission_id)</span>
<span class="s2">where active_time &gt; 10</span>
<span class="s2">group by active_time</span>
<span class="s2">order by active_time asc</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="s1">&#39;Active time in minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of submissions&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Distribution of Active Time of All Submissions&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="n">comment_diffs</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select active_time, count(*)</span>
<span class="s2">from</span>
<span class="s2">    (select submission_id, max(timediff) as active_time</span>
<span class="s2">    from</span>
<span class="s2">        (select </span>
<span class="s2">            d.posted_by, c.submission_id, </span>
<span class="s2">            (</span>
<span class="s2">                cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, c.posted_at) as integer) -</span>
<span class="s2">                cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, d.posted_at) as integer)</span>
<span class="s2">            )/60 as timediff</span>
<span class="s2">        from</span>
<span class="s2">            comments as c </span>
<span class="s2">        join</span>
<span class="s2">            submissions as d on c.submission_id==d.submission_id</span>
<span class="s2">        where</span>
<span class="s2">            c.posted_by!=&#39;AutoModerator&#39; </span>
<span class="s2">            and c.posted_by NOT LIKE &#39;%bot&#39; </span>
<span class="s2">            and c.posted_by!=&#39;[deleted]&#39;</span>
<span class="s2">            and d.link_flair_text=&#39;Politics&#39;)</span>
<span class="s2">    group by</span>
<span class="s2">    submission_id)</span>
<span class="s2">where active_time &gt; 10</span>
<span class="s2">group by active_time</span>
<span class="s2">order by active_time asc</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="s1">&#39;Active time in minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of submissions&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Distribution of Active Time of Political Submissions&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/active_time_submissions.png" width="80%">
<img src="https://hari.ai/images/reddit_da/active_time_political_submissions.png" width="80%"></p>
<p>It turns out that non-political posts are similarly active as political posts. Computing median of all posts and political posts shows that political posts actually are slightly less active compared to all posts. I guess political posts are probably occupying a lot more of my visual field whenever I browse r/india and that's probably not true with respect to everybody.</p>
<p>Just for the sake of completeness, we were considering average time to respond as one of the signal but we don't know if paid accounts are following certain simple rules to respond to comments. If so, it should show up as a spike in response time histogram. So let's plot it and see...</p>
<div class="highlight"><pre><span></span><span class="n">comment_diffs</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select timediff, count(*) </span>
<span class="s2">from</span>
<span class="s2">    (select </span>
<span class="s2">        (</span>
<span class="s2">            cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, c.posted_at) as integer) -</span>
<span class="s2">            cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, d.posted_at) as integer)</span>
<span class="s2">        )/60 as timediff</span>
<span class="s2">    from</span>
<span class="s2">        comments as c </span>
<span class="s2">    join</span>
<span class="s2">        submissions as d on c.submission_id==d.submission_id</span>
<span class="s2">    where</span>
<span class="s2">        c.posted_by!=&#39;AutoModerator&#39; </span>
<span class="s2">        and c.posted_by NOT LIKE &#39;%bot&#39; </span>
<span class="s2">        and c.posted_by!=&#39;[deleted]&#39;</span>
<span class="s2">        and timediff&gt;10)</span>
<span class="s2">group by</span>
<span class="s2">    timediff</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="s1">&#39;Time diff in minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Number of responses within a specified time&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/responses_within_specified_time.png" width="80%"></p>
<p>It looks like there isn't that big a spike if you exclude bots. It slides down naturally as one would expect. Maybe if we look at time to respond for political posts vs non-political posts, we may get some clues...</p>
<div class="highlight"><pre><span></span><span class="c1"># Response time to comments for political and all posts</span>
<span class="n">comment_diffs</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select timediff, count(*) </span>
<span class="s2">from</span>
<span class="s2">    (select</span>
<span class="s2">        (</span>
<span class="s2">            cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, c.posted_at) as integer) - </span>
<span class="s2">            cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;, d.posted_at) as integer)</span>
<span class="s2">        )/60 as timediff</span>
<span class="s2">    from</span>
<span class="s2">        comments as c </span>
<span class="s2">    join</span>
<span class="s2">        comments as d on SUBSTR(c.parent_comment_id, 4)=d.comment_id </span>
<span class="s2">    where</span>
<span class="s2">        c.parent_comment_id!=&#39;&#39; </span>
<span class="s2">        and c.posted_by!=&#39;AutoModerator&#39; </span>
<span class="s2">        and c.posted_by NOT LIKE &#39;%bot&#39; </span>
<span class="s2">        and c.posted_by!=&#39;[deleted]&#39;)</span>
<span class="s2">group by</span>
<span class="s2">    timediff</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="s1">&#39;Time diff in minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of comments&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Number of responses within a specified time&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">comment_diffs</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">select timediff, count(*) </span>
<span class="s2">from</span>
<span class="s2">    (select</span>
<span class="s2">        (cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span>
<span class="s2">        c.posted_at) as integer)-cast(strftime(&#39;</span><span class="si">%s</span><span class="s2">&#39;,</span>
<span class="s2">        d.posted_at) as integer))/60 as timediff </span>
<span class="s2">    from</span>
<span class="s2">        comments as c </span>
<span class="s2">    join</span>
<span class="s2">        comments as d </span>
<span class="s2">            on SUBSTR(c.parent_comment_id,</span>
<span class="s2">        4)=d.comment_id </span>
<span class="s2">    where</span>
<span class="s2">        c.parent_comment_id!=&#39;&#39; </span>
<span class="s2">        and c.posted_by!=&#39;AutoModerator&#39; </span>
<span class="s2">        and c.posted_by NOT LIKE &#39;%bot&#39; </span>
<span class="s2">        and c.posted_by!=&#39;[deleted]&#39; </span>
<span class="s2">        and c.submission_id in (</span>
<span class="s2">            select</span>
<span class="s2">                submission_id </span>
<span class="s2">            from</span>
<span class="s2">                submissions </span>
<span class="s2">            where</span>
<span class="s2">                link_flair_text=&#39;Politics&#39;</span>
<span class="s2">        )</span>
<span class="s2">    ) </span>
<span class="s2">group by</span>
<span class="s2">    timediff</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comment_diffs</span><span class="p">],</span> 
          <span class="s1">&#39;Time diff in minutes&#39;</span><span class="p">,</span> <span class="s1">&#39;Number of comments to political submissions&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;Number of responses to political submissions within a specified time&#39;</span><span class="p">,</span> 
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/num_responses_within_specified_time.png" width="80%">
<img src="https://hari.ai/images/reddit_da/num_responses_political_within_specified_time.png" width="80%"></p>
<p>No luck here either. It seems like political posts follow a similar response times as non-political posts. So far I don't have enough information to detect whether there are any paid accounts trying to influence the users to think certain way or not. My gut feeling says that there definitely are people with bad intentions but I haven't found a signal yet to differentiate them. I guess the search continues...</p>
<h2>Fancy Wordclouds</h2>
<p>If you thought that this analysis will complete without word clouds, you must be dreaming. Let's see what are the most common words in political submission titles and comments...</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span>
<span class="c1"># Submission title word cloud</span>
<span class="n">submission_title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">b64text</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;select title from submissions where link_flair_text=&#39;Politics&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64text</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">submission_title</span> <span class="o">+=</span> <span class="n">text</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
<span class="n">title_wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">submission_title</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">title_wordcloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Wordcloud of Political Submission Titles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>


<p>Output:</p>
<div class="highlight"><pre><span></span>(-0.5, 1199.5, 599.5, -0.5)
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/wordcloud_political_submission_title.png" width="80%"></p>
<div class="highlight"><pre><span></span><span class="c1"># Submission text word cloud</span>
<span class="n">submission_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">b64text</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="s2">&quot;select content from submissions where link_flair_text=&#39;Politics&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64text</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">submission_text</span> <span class="o">+=</span> <span class="n">text</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
<span class="n">text_wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">submission_text</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">text_wordcloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Wordcloud of Political Submission Content&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>


<p>Output:</p>
<div class="highlight"><pre><span></span>(-0.5, 1199.5, 599.5, -0.5)
</pre></div>


<p><img src="https://hari.ai/images/reddit_da/wordcloud_political_submission_content.png" width="80%"></p>
<h2>Code and Extras</h2>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">avro</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">praw</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">stylometry</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">avro.datafile</span> <span class="kn">import</span> <span class="n">DataFileReader</span>
<span class="kn">from</span> <span class="nn">avro.io</span> <span class="kn">import</span> <span class="n">DatumReader</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">multiprocessing.dummy</span> <span class="kn">import</span> <span class="n">Pool</span> <span class="k">as</span> <span class="n">ThreadPool</span>
<span class="kn">from</span> <span class="nn">stylometry.cluster</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">stylometry.extract</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">epoch</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">safe_int</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">val</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="k">class</span> <span class="nc">RedditDataLoader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;reddit.db&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_author_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reddit</span><span class="p">,</span> <span class="n">author_name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">author</span> <span class="o">=</span> <span class="n">reddit</span><span class="o">.</span><span class="n">redditor</span><span class="p">(</span><span class="n">author_name</span><span class="p">)</span>
            <span class="n">user_since</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">created_utc</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">author_name</span><span class="p">,</span> 
                <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">author_name</span><span class="p">,</span> <span class="n">user_since</span><span class="p">,</span> <span class="n">author</span><span class="o">.</span><span class="n">link_karma</span><span class="p">,</span> 
                    <span class="n">author</span><span class="o">.</span><span class="n">comment_karma</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span> <span class="s1">&#39;Failed with exception&#39;</span><span class="p">,</span> <span class="n">e</span>
            <span class="k">return</span> <span class="n">author_name</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">fetch_author_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reddit</span> <span class="o">=</span> <span class="n">praw</span><span class="o">.</span><span class="n">Reddit</span><span class="p">(</span><span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">client_secret</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> 
                <span class="n">username</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">user_agent</span><span class="o">=</span><span class="s1">&#39;script&#39;</span><span class="p">)</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">submission_authors</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="s1">&#39;select distinct(posted_by) from submissions&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()]</span>
        <span class="n">comment_authors</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="s1">&#39;select distinct(posted_by) from comments&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()]</span>
        <span class="n">all_authors</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">submission_authors</span> <span class="o">+</span> <span class="n">comment_authors</span><span class="p">)))</span>
        <span class="nb">print</span> <span class="s1">&#39;Found </span><span class="si">%d</span><span class="s1"> authors&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_authors</span><span class="p">)</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">ThreadPool</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">all_authors_data</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">author</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_author_info</span><span class="p">(</span><span class="n">reddit</span><span class="p">,</span> <span class="n">author</span><span class="p">),</span> <span class="n">all_authors</span><span class="p">)</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="nb">print</span> <span class="s1">&#39;Done fetching data&#39;</span>
        <span class="k">for</span> <span class="n">author_name</span><span class="p">,</span> <span class="n">author_details</span> <span class="ow">in</span> <span class="n">all_authors_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">author_details</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_author_details</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">author_name</span><span class="p">,</span> <span class="n">author_details</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">identify_submission_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">comment_submissions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">comment_parents</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;select </span>
<span class="sd">                    comments.comment_id, submissions.submission_id </span>
<span class="sd">                from submissions </span>
<span class="sd">                join comments on </span>
<span class="sd">                    submissions.submission_id=SUBSTR(comments.parent_comment_id,4)&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="nb">print</span> <span class="s1">&#39;Find submission of comments which have already been tagged that way&#39;</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">comments</span><span class="p">:</span>
            <span class="n">comment_submissions</span><span class="p">[</span><span class="n">comment</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">comment</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;Found </span><span class="si">%d</span><span class="s1"> comments that are direct replies to a submission&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">comments</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s1">&#39;Finding parents of all comments&#39;</span>
        <span class="n">no_sub_comments</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                select comment_id, SUBSTR(parent_comment_id, 4) as parent_id </span>
<span class="s2">                from comments&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">no_sub_comments</span><span class="p">:</span>
            <span class="n">comment_parents</span><span class="p">[</span><span class="n">comment</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">comment</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;Found </span><span class="si">%d</span><span class="s1"> comments&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">no_sub_comments</span><span class="p">)</span>
        <span class="c1"># Find submission of all the comments</span>
        <span class="nb">print</span> <span class="s1">&#39;Find submissions that comments belong to&#39;</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">comment_parents</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">comment</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">comment_submissions</span><span class="p">:</span>
                <span class="n">submission</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">comment_parents</span><span class="p">[</span><span class="n">comment</span><span class="p">]</span>
                <span class="k">while</span> <span class="p">(</span>
                    <span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> 
                    <span class="n">parent</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">comment_submissions</span> <span class="ow">and</span> 
                    <span class="n">parent</span> <span class="ow">in</span> <span class="n">comment_parents</span><span class="p">):</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">comment_parents</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">parent</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">comment_submissions</span><span class="p">:</span>
                    <span class="n">comment_submissions</span><span class="p">[</span><span class="n">comment</span><span class="p">]</span> <span class="o">=</span> <span class="n">comment_submissions</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span>
        <span class="nb">print</span> <span class="s1">&#39;Updating submission id for </span><span class="si">%d</span><span class="s1"> comments&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment_submissions</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">comment_submissions</span><span class="p">:</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
                <span class="s2">&quot;update comments set submission_id=&#39;</span><span class="si">%s</span><span class="s2">&#39; where comment_id=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">comment_submissions</span><span class="p">[</span><span class="n">comment</span><span class="p">],</span> <span class="n">comment</span><span class="p">))</span>
        <span class="nb">print</span> <span class="s1">&#39;Committing changes&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="nb">print</span> <span class="s1">&#39;Done making all the changes&#39;</span>

    <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">submission_file_name</span><span class="p">,</span> <span class="n">comment_file_name</span><span class="p">):</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="c1"># read and load submissions</span>
        <span class="nb">print</span> <span class="s1">&#39;Reading and loading submissions data&#39;</span>
        <span class="n">submission_file</span> <span class="o">=</span> <span class="n">DataFileReader</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">submission_file_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">),</span> <span class="n">DatumReader</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">submission</span> <span class="ow">in</span> <span class="n">submission_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_submission_details</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">submission</span><span class="p">)</span>

        <span class="c1"># read and load submissions</span>
        <span class="nb">print</span> <span class="s1">&#39;Reading and loading comments data&#39;</span>
        <span class="n">comment_file</span> <span class="o">=</span> <span class="n">DataFileReader</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">comment_file_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">),</span> <span class="n">DatumReader</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">comment_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_comment_details</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="c1"># If some tables exist, we don&#39;t need to create new ones</span>
        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT count(*) FROM sqlite_master where type=&#39;table&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE users </span>
<span class="s1">                        (user_id text PRIMARY KEY, user_since timestamp, </span>
<span class="s1">                        link_karma real, comment_karma real)&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE submissions</span>
<span class="s1">                        (submission_id text PRIMARY KEY, title text, content text,</span>
<span class="s1">                        link_flair_text text, posted_at timestamp, posted_by text, </span>
<span class="s1">                        upvotes int, downvotes int, score int, num_comments int)&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE comments</span>
<span class="s1">                        (comment_id text PRIMARY KEY, submission_id text, parent_comment_id text,</span>
<span class="s1">                        content text, posted_at timestamp, posted_by text,</span>
<span class="s1">                        upvotes int, downvotes int, score int)&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_submission_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">submission</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">created_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">]))</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM submissions WHERE submission_id=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">submission</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">values</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> 
                        <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)),</span> 
                        <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;selftext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)),</span> 
                        <span class="n">submission</span><span class="p">[</span><span class="s1">&#39;link_flair_text&#39;</span><span class="p">],</span> <span class="n">created_at</span><span class="p">,</span> <span class="n">submission</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">],</span> 
                        <span class="n">safe_int</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;ups&#39;</span><span class="p">]),</span> <span class="n">safe_int</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;downs&#39;</span><span class="p">]),</span> 
                        <span class="n">safe_int</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]),</span> <span class="n">safe_int</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;num_comments&#39;</span><span class="p">]))</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO submissions VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">values</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span><span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span> <span class="n">submission</span><span class="p">,</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">_add_comment_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
        <span class="n">created_at</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">comment</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">]))</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM comments WHERE comment_id=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">comment</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">values</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, &#39;</span><span class="si">%s</span><span class="s2">&#39;, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">comment</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">comment</span><span class="p">[</span><span class="s1">&#39;parent_id&#39;</span><span class="p">],</span>
                    <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">comment</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)),</span> 
                    <span class="n">created_at</span><span class="p">,</span> <span class="n">comment</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">],</span> <span class="n">safe_int</span><span class="p">(</span><span class="n">comment</span><span class="p">[</span><span class="s1">&#39;ups&#39;</span><span class="p">]),</span> 
                    <span class="n">safe_int</span><span class="p">(</span><span class="n">comment</span><span class="p">[</span><span class="s1">&#39;downs&#39;</span><span class="p">]),</span> <span class="n">safe_int</span><span class="p">(</span><span class="n">comment</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]))</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO comments VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_author_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">author_name</span><span class="p">,</span> <span class="n">author_details</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE user_id=&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">author_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;INSERT INTO users VALUES (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">author_details</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span> <span class="n">e</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">data_loader</span> <span class="o">=</span> <span class="n">RedditDataLoader</span><span class="p">()</span>
    <span class="c1">#data_loader.identify_submission_comments()</span>
    <span class="c1">#data_loader.create_tables()</span>
    <span class="c1">#data_loader.read_data(&#39;data/submissions.avro&#39;, &#39;data/comments.avro&#39;)</span>
    <span class="c1">#data_loader.fetch_author_info()</span>
    <span class="nb">print</span> <span class="s1">&#39;Done loading&#39;</span>
</pre></div>
      </div>
<!-- /.entry-content -->
      <footer class="post-info text-muted">
        <button type="button" class="btn btn-default">          
          <a href="https://hari.ai/category/exploration.html"><div class="fa fa-lg fa-folder-open"></div> Exploration</a>
        </button>
      </footer>
      <!-- /.post-info -->
    <!-- Comment BEGIN -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'hari-ai';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <!-- Comment END -->
    </section>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="footer-text text-center">&copy; <a href="https://hari.ai">Hari Govardhanam</a> powered by <a href="http://getpelican.com/">pelican</a></p>
      </div>
    </footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>